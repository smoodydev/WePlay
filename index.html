<!DOCTYPE html>
<html>

<head>
    <title>Grid Game</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <canvas id="gameCanvas" width="220" height="220"></canvas>

    <script>
        // Game settings
        const gridSize = 11;
        const cellSize = 20;
        const canvasSize = gridSize * cellSize;
        const vision = 5;

        let player = {
            x: 10,
            y: 10,

        }

        let map = 0;
        // Create canvas context
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');


        // Create the grid
        const map0 = [
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [1, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ];
        const map1 = [
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [1, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 51, 51, 51, 51, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 3, 3, 3, 3, 3, 3, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 50, 2, 1, 0],
            [0, 1, 2, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 2, 1, 0],
            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],
            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
        ];

        map2 = [
            [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1
        ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                50,
                50,
                1,
                50,
                50,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                2,
                2,
                2,
                2,
                2,
                2,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ],
            [
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1
            ]
    ]


        maps = [map0, map1, map2]

        let grid = maps[2]

        // Render the grid
        function renderGrid() {
            ctx.clearRect(0, 0, canvasSize, canvasSize);
            let m_size = (vision * 2) + 1;
            for (let y = 0; y <= m_size; y++) {
                for (let x = 0; x <= m_size; x++) {

                    let cellValue;
                    try {
                        cellValue = grid[player.y - vision + y][player.x - vision + x];
                        console.log(cellValue)
                    } catch (error) {
                        cellValue = 0;
                    }
                    let color;

                    switch (cellValue) {
                        case 1:
                            color = 'green';
                            break;
                        case 2:
                            color = 'yellow';
                            break;
                        case 3:
                            color = 'grey';
                            break;
                        case 50:
                            color = 'blue';
                            break;
                        case 51:
                            color = 'orange';
                            break;
                        case 'empty':
                        default:
                            color = 'black';
                    }

                    ctx.fillStyle = color;
                    ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);

                }
            }
            ctx.fillStyle = "red";
            ctx.fillRect(5 * cellSize, 5 * cellSize, cellSize, cellSize);
        }
        document.addEventListener('keydown', (event) => {
            const key = event.key;
            switch (key) {
                case 'w':
                    if (isValid(0, -1)) {
                        player.y--;
                        renderGrid();
                    }

                    break;
                case 'a':
                    if (isValid(-1, 0)) {
                        player.x--;
                        renderGrid();
                    }
                    break;
                case 's':
                    if (isValid(0, 1)) {
                        player.y++;
                        renderGrid();
                    }
                    break;

                case 'd':
                    if (isValid(1, 0)) {
                        player.x++;
                        renderGrid();
                    }
                    break;
                default:
                    break;
            }
        });
        function isValid(x, y) {
            console.log(grid[player.y][player.x]);
            moveTo = grid[player.y + y][player.x + x];
            console.log(moveTo)
            if (moveTo && moveTo < 50) {
                return true;
            }
        }
        renderGrid();

    </script>
</body>

</html>